<!DOCTYPE html>
<html>
  <head>
    <title>KeyPass</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&display=swap"
    />
    <style>
      @keyframes flicker {
        0%,
        19%,
        21%,
        23%,
        25%,
        54%,
        56%,
        100% {
          text-shadow: 0 0 5px #00ff00, 0 0 10px #00ff00, 0 0 20px #00ff00,
            0 0 40px #00c800, 0 0 80px #00c800;
          opacity: 1;
        }
        20%,
        24%,
        55% {
          text-shadow: none;
          opacity: 0.6;
        }
      }

      @keyframes glitch {
        0% {
          transform: translate(0);
        }
        20% {
          transform: translate(-3px, 3px);
        }
        40% {
          transform: translate(-3px, -3px);
        }
        60% {
          transform: translate(3px, 3px);
        }
        80% {
          transform: translate(3px, -3px);
        }
        100% {
          transform: translate(0);
        }
      }

      @keyframes scanline {
        0% {
          background-position: 0 0;
        }
        100% {
          background-position: 0 100%;
        }
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        background-color: #050a05;
        color: #c0fcc0;
        font-family: "Roboto Mono", monospace;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 20px;
        position: relative;
        overflow: hidden;
      }

      body::before {
        content: "";
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-image: linear-gradient(
          0deg,
          rgba(0, 255, 0, 0.1) 1px,
          transparent 1px
        );
        background-size: 100% 3px;
        animation: scanline 10s linear infinite;
        pointer-events: none;
        z-index: -1;
      }

      .container {
        width: 100%;
        max-width: 600px;
      }

      .header {
        text-align: center;
        margin-bottom: 40px;
      }

      h1 {
        font-size: 2.8rem;
        font-weight: 700;
        color: #00ff00;
        text-transform: uppercase;
        animation: flicker 4s linear infinite;
      }

      .subtitle {
        color: #8a9a8a;
        font-size: 1.1rem;
      }

      .glass-panel,
      .modern-btn,
      .password-card {
        background: rgba(0, 20, 0, 0.5);
        border: 1px solid rgba(0, 255, 0, 0.4);
        border-radius: 0;
        backdrop-filter: blur(5px);
        transition: all 0.2s ease;
      }

      .modern-btn:hover,
      .password-card:hover {
        background: rgba(0, 50, 0, 0.7);
        color: #fff;
        animation: glitch 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94) both;
      }

      .modern-btn {
        padding: 12px 20px;
        color: #00ff00;
        font-weight: 700;
        font-size: 16px;
        cursor: pointer;
        text-transform: uppercase;
      }

      .menu-btn {
        border-color: rgba(0, 255, 0, 0.7) !important;
      }

      .glass-panel {
        padding: 30px;
      }

      .form-group {
        margin-bottom: 20px;
      }

      label {
        display: block;
        color: #00ff00;
        font-weight: 700;
        margin-bottom: 8px;
        font-size: 14px;
        text-transform: uppercase;
      }

      input,
      select {
        width: 100%;
        padding: 15px;
        background: #050a05;
        border: 1px solid rgba(0, 255, 0, 0.4);
        border-radius: 0;
        color: #c0fcc0;
        font-size: 16px;
        font-family: "Roboto Mono", monospace;
      }

      input:focus,
      select:focus {
        outline: 1px solid #00ff00;
        box-shadow: 0 0 15px rgba(0, 255, 0, 0.5);
      }

      select option {
        background: #050a05;
        color: #c0fcc0;
      }

      .submit-btn {
        width: 100%;
        padding: 15px;
        background: #00ff00;
        border: none;
        color: #050a05;
        font-weight: 700;
        font-size: 16px;
        cursor: pointer;
        text-transform: uppercase;
      }

      .password-grid {
        display: grid;
        grid-template-columns: 1fr;
        gap: 10px;
      }

      .password-card {
        padding: 20px;
        cursor: pointer;
        user-select: none;
        text-align: center;
      }

      .password-name {
        color: #c0fcc0;
        font-weight: 700;
        font-size: 18px;
        text-shadow: 0 0 5px rgba(0, 255, 0, 0.7);
      }
      .password-card:hover .password-name {
        color: #fff;
      }

      .hidden {
        display: none !important;
      }

      .loading {
        display: inline-block;
        width: 20px;
        height: 20px;
        border: 2px solid rgba(0, 255, 0, 0.3);
        border-radius: 50%;
        border-top-color: #00ff00;
        animation: spin 1s linear infinite;
      }
      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      summary {
        cursor: pointer;
        color: #00ff00;
        font-weight: 700;
        padding: 10px;
        border: 1px solid rgba(0, 255, 0, 0.4);
        margin-top: 20px;
      }

      .password-grid {
        counter-reset: password-counter;
      }

      .password-card {
        display: flex;
        align-items: baseline;
        padding: 15px 20px;
        text-align: left;
      }

      .password-card::before {
        counter-increment: password-counter;
        content: counter(password-counter, decimal-leading-zero);
        color: #8a9a8a;
        font-weight: 700;
        margin-right: 15px;
        min-width: 25px;
      }

      .password-prompt {
        color: #00ff00;
        font-weight: 700;
        margin-right: 15px;
      }

      .password-name {
        flex-grow: 1;
      }

      .password-card {
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .password-details {
        display: flex;
        align-items: baseline;
        flex-grow: 1;
        cursor: pointer;
      }

      .edit-btn {
        background: none;
        border: 1px solid rgba(0, 255, 0, 0.4);
        color: #00ff00;
        font-size: 120%;
        width: 40px;
        height: 40px;
        cursor: pointer;
        margin-left: 15px;
        transition: all 0.2s ease;
      }

      .edit-btn:hover {
        background: rgba(0, 50, 0, 0.7);
        color: #fff;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>KeyPass</h1>
        <p id="subtitle" class="subtitle">Password Management System</p>

        <button
          id="add-button"
          onclick="shake('add-button'); toggleCreatePassForm()"
          class="modern-btn menu-btn"
          role="button"
          style="
            position: absolute;
            top: 20px;
            left: 20px;
            padding: 0;
            font-size: 200%;
            width: 50px;
            height: 50px;
            z-index: 10;
          "
        >
          +
        </button>
        <button
          id="settings-button"
          onclick="shake('settings-button'); toggleSettings()"
          class="modern-btn menu-btn"
          role="button"
          style="
            position: absolute;
            top: 20px;
            right: 20px;
            padding: 0;
            font-size: 200%;
            width: 50px;
            height: 50px;
            z-index: 10;
          "
        >
          &#9881;
        </button>
      </div>
      <div class="mainScreen hidden" id="settingsForm">
        <div class="glass-panel button-column">
          <button
            class="modern-btn column togglableButton"
            role="button"
            data-setting="confirm_actions"
            data-enabled-text="Confirm actions"
            data-disabled-text="Just run actions"
          >
            Ask for confirmations
          </button>
          <button
            class="modern-btn column togglableButton"
            role="button"
            data-setting="password_visibility"
            data-enabled-text="Show passwords"
            data-disabled-text="Hide passwords"
          >
            Ask for confirmations
          </button>
          <button
            class="modern-btn column"
            role="button"
            onclick="window.location.pathname = '/dump'"
            style="background: rgba(107, 255, 107, 0.2)"
          >
            Backup passwords blob
          </button>
          <button
            class="modern-btn column"
            role="button"
            onclick="toggleWifiPassForm()"
          >
            Change Wi-Fi password
          </button>
          <div
            id="wifiPassForm"
            class="hidden"
            style="overflow: hidden; transition: all 0.3s ease-out"
          >
            <div class="glass-panel" style="margin-top: 10px">
              <div class="form-group">
                <input
                  class="passwordLength"
                  type="password"
                  id="newWifiPass"
                  placeholder="New Wi-Fi password"
                  minlength="8"
                  maxlength="31"
                  required
                />
                <input
                  class="passwordLength"
                  type="password"
                  id="confirmWifiPass"
                  placeholder="Confirm password"
                  minlength="8"
                  maxlength="31"
                  required
                />
                <button
                  type="button"
                  onclick="updateWifiPass()"
                  class="submit-btn"
                >
                  <span class="btn-text">Update Password</span>
                  <span class="loading hidden"></span>
                </button>
              </div>
            </div>
          </div>
          <button
            class="modern-btn column"
            role="button"
            onclick="checkPassphrase({force:true})"
            style="background: rgba(255, 107, 107, 0.2)"
          >
            Reset passphrase
          </button>
          <button
            class="modern-btn column"
            role="button"
            onclick="confirmFactoryReset()"
            style="background: rgba(255, 107, 107, 0.2)"
          >
            Factory Reset
          </button>
          <div id="passwdRecoveryInputs">
            <input type="file" id="blobFileInput" />
            <textarea
              id="blobTextInput"
              placeholder="Paste blob file content here..."
              rows="4"
              style="width: 100%; display: none"
            ></textarea>
          </div>
          <button
            class="modern-btn column"
            role="button"
            onclick="uploadBlobFile()"
          >
            Recover passwords from blob
          </button>
          <button
            class="modern-btn column"
            role="button"
            onclick="alert(localStorage.getItem('keypass_passphrase'))"
          >
            Show passphrase
          </button>
        </div>
      </div>

      <div class="mainScreen hidden" id="editForm">
        <div class="glass-panel">
          <form id="editFormContent" method="get" action="/editPass">
            <input type="hidden" name="id" id="positionSelect" disabled />

            <div class="form-group">
              <label for="passLabel">Name</label>
              <input
                class="passwordLength"
                id="passLabel"
                name="name"
                type="text"
                required
                placeholder="Enter password name"
                maxlength="29"
              />

              <label for="passwordInput">Password</label>
              <div style="display: flex; gap: 10px">
                <input
                  class="passwordLength"
                  id="passwordInput"
                  type="password"
                  name="password"
                  placeholder="Enter password..."
                  maxlength="31"
                />

                <button
                  id="toggleVisibilityIcon"
                  type="button"
                  class="modern-btn togglableButton"
                  data-setting="password_visibility"
                  data-enabled-text="&#x1F640;"
                  data-disabled-text="&#x1f648;"
                  data-changed="togglePasswordVisibility"
                  style="
                    width: 50px;
                    flex: 0 0 auto;
                    padding: 0;
                    font-size: 200%;
                  "
                >
                  &#x1f648;
                </button>
                <button
                  type="button"
                  onclick="generatePass(this)"
                  class="modern-btn"
                  style="
                    width: 60px;
                    flex: 0 0 auto;
                    padding: 0;
                    font-size: 180%;
                  "
                >
                  &#127922;
                </button>
              </div>
              <div style="display: flex; gap: 10px; margin-top: 10px">
                <button
                  id="typeNewPassBtn"
                  type="button"
                  onclick="typeNewPass()"
                  class="modern-btn hidden"
                  style="width: auto; flex: auto"
                >
                  <span style="vertical-align: -15%; font-size: 200%">
                    &#x2328;</span
                  >&nbsp;&nbsp;Type
                </button>
                <button
                  id="typeOldPassBtn"
                  type="button"
                  onclick="typeOldPass()"
                  class="modern-btn hidden"
                  style="width: auto; flex: auto"
                >
                  <span style="vertical-align: -15%; font-size: 200%"
                    >&#x2328;</span
                  >&nbsp;&nbsp;Type current (already registered)
                </button>
              </div>
              <label for="layoutSelect">Keyboard layout</label>
              <select name="lang" id="layoutSelect" required>
                <option value="bitlocker">F1-F12 (bitlocker)</option>
                <option value="fr">French</option>
                <option value="us">US</option>
              </select>
              <input type="hidden" name="layout" id="layoutIndex" />
            </div>
            <button type="submit" class="submit-btn">
              <span class="btn-text">Save Password</span>
              <span class="loading hidden"></span>
            </button>
          </form>
        </div>
      </div>

      <div id="passList" class="mainScreen">
        <div class="password-grid">
          <!-- Passwords will be loaded here -->
        </div>
        <details id="advancedTypingOptions" style="padding: 1ex">
          <summary>Advanced options</summary>
          <div class="form-group">
            <p style="padding: 1ex"></p>
            <div>
              <label for="typePasswordPressEnter"
                >After typing a password:</label
              >
              <button
                id="typePasswordPressEnter"
                class="modern-btn column togglableButton"
                role="button"
                data-setting="press_enter"
                data-enabled-text="Press &crarr;"
                data-disabled-text="Do not press &crarr;"
              ></button>
            </div>
            <p style="padding: 1ex">
              <label for="layoutOverrideSelect"
                >Keyboard layout override:</label
              >
              <select name="lang" id="layoutOverrideSelect" required>
                <option value="">Password specific</option>
                <option value="fr">French</option>
                <option value="us">US</option>
              </select>
            </p>
          </div>
          <p>&nbsp;</p>
        </details>
      </div>
    </div>
    <script>
      <!-- WARN: The following line must not be changed and is replaced with index.js content automatically -->
      <!-- CODE HERE -->
    </script>
  </body>
</html>
<!-- vim:ts=2:sw=2:et:
-->
